{{ docker.from("samson", user="zendesk") }}

{{ environment.general() }}
{{ environment.base() }}
{{ environment.baseApp() }}

###############################################################################
# Bootstrap
###############################################################################

{{ docker.add('baselayout.tar', '/') }}

{{ bootstrap.debian('jessie') }}

###############################################################################
# Base
###############################################################################

{{ docker.copy('conf/', '/opt/docker/') }}

{{ ansible.debian() }}

{{ base.debian() }}

###############################################################################
# Base-app
###############################################################################

{{ baseapp.debian() }}

###############################################################################
# Samson
###############################################################################

{{ samsonDeployment.general() }}

{{ docker.expose('80') }}
{{ docker.volume('/storage') }}

{{ docker.entrypoint("/opt/docker/bin/entrypoint.sh") }}
{{ docker.cmd("supervisord") }}
